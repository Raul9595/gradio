<script>
    document.querySelector("base").href = "https://localhost:$PORT";

    function rehydrate() {
        for (const script of document.querySelectorAll("script")) {
            const newScript = document.createElement('script')
            newScript.type = script.type;
            newScript.src = script.src;
            newScript.textContent = script.textContent;
            const head = document.getElementsByTagName('head')[0];
            if (script.textContent.includes("window.gradio_config =")) {
                const config_re = /^\s*window.gradio_config\s*=\s*({[^]+})\s*;\s*$/;
                window.gradio_config = JSON.parse(config_re.exec(script.textContent)[1]);            }
            head.appendChild(newScript);
            newScript.remove();
        }

        console.log(window)
    }
    fetch(".")
        .then((x) => x.text())
        .then((html) => {
            document.body.innerHTML = html;
        })
        .then(() => rehydrate());
</script>
